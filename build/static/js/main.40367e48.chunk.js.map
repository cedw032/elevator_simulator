{"version":3,"sources":["hooks/useAsyncState.js","utils/dispatcher.js","constants/elevatorEvents.js","models/elevator.js","constants/elevatorState.js","constants/direction.js","models/usageSimulator.js","hooks/useForceUpdate.js","components/TimeController.js","components/TestSettingsController.js","hooks/useForceUpdateOnEvents.js","components/FloorDisplay.js","components/ElevatorDisplay.js","App.js","serviceWorker.js","index.js"],"names":["state","provideDispatcher","eventTypes","listeners","reduce","dispatcher","eventType","on","listener","push","filter","current","dispatch","_len","arguments","length","params","Array","_key","forEach","apply","ELEVATOR_EVENTS","provideElevator","floorCount","elevatorState","openTime","moveTime","currentFloor","currentDirection","destinations","requests","openTimeout","floors","i","canChangeDirection","filterFloorsAhead","floor","destinationsAhead","map","request","shouldOpen","destinationsAtCurrentFloor","requestsAtCurrentFloor","requestsAlsoMatchingCurrentDirection","destination","direction","isOpen","moveToNextFloor","allowDoorsToClose","_provideDispatcher","addDestination","destinationAdded","requestElevator","elevatorRequested","elapseTime","requestFilter","doorsOpen","openDoors","doorsClose","floorChange","timeElapsed","setOpenTimeout","value","concat","isDestination","isRequested","provideUsageSimulator","elevator","unsubscribeTimeElapsed","enabled","spawn","randomInteger","min","max","Math","round","random","randomFloor","slice","origin","destinationEntered","cancelListener","elevatorDirection","toggle","undefined","useForceUpdate","_useState","useState","update","Object","slicedToArray","useAsyncState","initial","forceUpdate","TimeController","_ref","_useAsyncState","_useAsyncState2","asyncAutoplay","setAutoplay","useEffect","startAutoplay","setTimeout","applyAutoplayTimestep","react_default","a","createElement","className","children","onClick","cx","TestSettingsController","usageSimulator","useForceUpdateOnEvents","subscribeMethods","unsubscribeMethods","subscribe","unsubscribe","FloorDisplay","disabled","ElevatorDisplay","key","App","components_TimeController","components_TestSettingsController","components_FloorDisplay","components_ElevatorDisplay","Boolean","window","location","hostname","match","ReactDOM","render","src_App","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.40367e48.chunk.js","sourcesContent":["import {useState} from 'react';\nimport useForceUpdate from './useForceUpdate';\n\nlet state;\n\nconst useAsyncState = (initial) => {\n\n\tif (!state) state = {value: initial};\n\n\tconst forceUpdate = useForceUpdate();\n\n\tconst updateValue = (value) => {\n\t\tif (value !== state.value) {\n\t\t\tstate.value = value;\n\t\t\tforceUpdate();\n\t\t}\n\t};\n\n\treturn [state, updateValue];\n}\n\nexport default useAsyncState;","const provideDispatcher = eventTypes => {\n\n\tconst listeners = {};\n\n\treturn eventTypes.reduce((dispatcher, eventType) => {\n\t\tlisteners[eventType] = [];\n\n\t\tdispatcher.on[eventType] = listener => {\n\t\t\tlisteners[eventType].push(listener);\n\n\t\t\treturn () => {\n\t\t\t\tlisteners[eventType] = listeners[eventType].filter(\n\t\t\t\t\tcurrent => current !== listener\n\t\t\t\t);\n\t\t\t};\n\t\t};\n\n\t\tdispatcher.dispatch[eventType] = (...params) => {\n\t\t\tlisteners[eventType].forEach(listener => listener(...params));\n\t\t};\n\n\t\treturn dispatcher;\n\n\t}, {dispatch: {}, on: {}});\n\n}\n\nexport default provideDispatcher;","const ELEVATOR_EVENTS = [\n\t'doorsOpen',\n\t'doorsClose',\n\t'floorChange',\n\t'timeElapsed',\n\t'elevatorRequested',\n\t'destinationAdded',\n];\n\nexport default ELEVATOR_EVENTS;","import provideDispatcher from '../utils/dispatcher';\n\n//////////////// CONSTANTS\nimport {UP, DOWN} from '../constants/direction';\nimport {STOPPED, OPEN, MOVING} from '../constants/elevatorState';\nimport ELEVATOR_EVENTS from '../constants/elevatorEvents';\n//////////////// CONSTANTS // END\n\nconst provideElevator = (floorCount) => {\n\n\t//////////////// INTERNAL STATE\n\tlet elevatorState = STOPPED;\n\tlet openTime = 0;\n\tlet moveTime = 0;\n\tlet currentFloor = 1;\n\tlet currentDirection = UP;\n\tlet destinations = [];\n\tlet requests = [];\n\n\tlet openTimeout = 0;\n\tlet timestepsBetweenFloors = 0;\n\n\tconst floors = [];\n\tfor (let i = 1; i <= floorCount; ++i) floors.push(i);\n\t///////////////// INTERNAL STATE // END\n\n\t///////////////// INTERNAL DERIVED STATE\n\tconst hasFloorToMoveTo = () => {\n\t\treturn !!(destinations.length + requests.length);\n\t};\n\n\tconst canChangeDirection = () => {\n\n\t\tconst filterFloorsAhead = floor => floor * currentDirection > currentFloor * currentDirection;\n\n\t\tconst destinationsAhead = destinations.filter(filterFloorsAhead);\n\n\t\tconst requestFloorsAhead = requests.map(\n\t\t\trequest => request.floor\n\t\t).filter(filterFloorsAhead);\n\n\t\treturn !(requestFloorsAhead.length + destinationsAhead.length);\n\t};\n\n\tconst shouldOpen = () => {\n\t\t\n\t\tif (destinationsAtCurrentFloor().length) return true;\n\n\t\tif (requestsAtCurrentFloor().length) {\n\t\t\tif (canChangeDirection()) return true;\n\t\t\tif (requestsAlsoMatchingCurrentDirection().length) return true;\n\t\t}\n\n\t\treturn false;\n\n\t};\n\n\tconst destinationsAtCurrentFloor = () => destinations.filter(\n\t\tdestination => destination == currentFloor\n\t);\n\n\tconst requestsAtCurrentFloor = () => requests.filter(\n\t\trequest => request.floor == currentFloor\n\t);\n\n\tconst requestsAlsoMatchingCurrentDirection =  () => requestsAtCurrentFloor().filter(\n\t\trequest => request.direction == currentDirection\n\t);\n\n\tconst isOpen = () => elevatorState == OPEN;\n\n\t///////////////// INTERNAL DERIVED STATE // END\n\n\n\t///////////////// ACTIONS\n\tconst addDestination = floor => {\n\t\tdestinations.push(floor);\n\t\tif (elevatorState == OPEN) allowDoorsToClose();\n\t\tdispatch.destinationAdded();\n\t};\n\n\tconst requestElevator = (floor, direction) => {\n\t\trequests.push({floor, direction});\n\t\tdispatch.elevatorRequested();\n\t}\n\n\tconst moveToNextFloor = () => {\n\t\tmoveTime = 0;\n\t\televatorState = MOVING;\n\t};\n\n\tconst closeDoors = () => {\n\t\televatorState = STOPPED;\n\t\tdispatch.doorsClose();\n\t};\n\n\tconst stopElevator = () => elevatorState = STOPPED;\n\n\tconst openDoors = () => {\n\t\topenTime = 0;\n\n\t\tdestinations = destinations.filter(\n\t\t\tdestination => destination != currentFloor\n\t\t);\n\n\t\tconst requestFilter = canChangeDirection()\n\t\t\t? request => request.floor != currentFloor\n\t\t\t: request => request.floor != currentFloor || request.direction != currentDirection;\n\n\t\trequests = requests.filter(requestFilter);\n\n\t\televatorState = OPEN;\n\t\tdispatch.doorsOpen(currentFloor, currentDirection, canChangeDirection());\n\t};\n\n\tconst updateCurrentFloor = () => {\n\t\tcurrentFloor += currentDirection;\n\t\tdispatch.floorChange();\n\t};\n\n\tconst updateCurrentDirection = () => {\n\t\tif (canChangeDirection()) {\n\t\t\tcurrentDirection *= DOWN;\n\t\t}\n\t};\n\n\tconst canDoorsClose = () => {\n\t\treturn openTime >= openTimeout;\n\t};\n\n\tconst allowDoorsToClose = () => {\n\t\tif (isOpen()) {\n\t\t\topenTime = openTimeout;\n\t\t}\n\t};\n\n\tconst elapseTime = () => {\n\t\tswitch (elevatorState) {\n\t\t\tcase STOPPED:\n\t\t\t\tif (shouldOpen()) {\n\t\t\t\t\topenDoors();\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tif (hasFloorToMoveTo()) {\n\t\t\t\t\tupdateCurrentDirection();\n\t\t\t\t\tmoveToNextFloor();\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase OPEN:\n\t\t\t\tif (canDoorsClose()) {\n\t\t\t\t\tcloseDoors();\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\t++openTime;\n\t\t\t\tbreak;\n\n\t\t\tcase MOVING:\n\t\t\t\tif (moveTime >= timestepsBetweenFloors) {\n\t\t\t\t\tupdateCurrentFloor();\n\n\t\t\t\t\tif (shouldOpen()) {\n\t\t\t\t\t\tstopElevator();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tmoveToNextFloor();\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\t++moveTime;\n\t\t\t\tbreak;\n\t\t}\n\n\t\tdispatch.timeElapsed();\n\t};\n\n\t///////////////// DISPATCHER\n\tconst {dispatch, on} = provideDispatcher(ELEVATOR_EVENTS);\n\t///////////////// DISPATCHER // END\n\n\t///////////////// PUBLIC INTERFACE\n\treturn {\n\t\taddDestination,\n\t\trequestElevator,\n\t\telapseTime,\n\t\tallowDoorsToClose,\n\n\t\tsetOpenTimeout: value => openTimeout = value,\n\n\t\tcurrentFloor: () => currentFloor,\n\t\tfloors: () => [...floors],\n\t\tisOpen,\n\n\t\tisDestination: floor => destinations.filter(\n\t\t\tdestination => destination == floor\n\t\t).length != 0,\n\n\t\tisRequested: (floor, direction) => requests.filter(\n\t\t\trequest => request.floor == floor && request.direction == direction\n\t\t).length != 0,\n\n\t\ton,\n\t};\n\t///////////////// PUBLIC INTERFACE // END\n\n}\n\nexport default provideElevator;","export const STOPPED = 0;\nexport const OPEN = 1;\nexport const MOVING = 2;","export const UP = 1;\nexport const DOWN = -1;","import {UP, DOWN} from '../constants/direction';\n\nconst provideUsageSimulator = elevator => {\n\n\tlet unsubscribeTimeElapsed;\n\tlet spawnChance = 0.16;\n\n\tconst enabled = () => {\n\t\treturn !!unsubscribeTimeElapsed;\n\t}\n\n\tconst toggle = () => {\n\n\t\tif (enabled()) {\n\t\t\tunsubscribeTimeElapsed();\n\t\t\tunsubscribeTimeElapsed = undefined;\n\t\t\treturn;\n\t\t}\n\n\t\tunsubscribeTimeElapsed = elevator.on.timeElapsed(elapseTime);\n\n\t};\n\n\tconst spawn = () => {\n\t\t\n\t\tconst randomInteger = (min, max) => \n\t\t\tMath.round((max - min) * Math.random()) + min;\n\n\t\tconst randomFloor = () => randomInteger(\n\t\t\televator.floors()[0], \n\t\t\t+elevator.floors().slice(-1)\n\t\t);\n\n\t\tconst entering = 1;\n\t\tconst exiting = -1;\n\n\t\tlet origin = 0;\n\t\tlet destination = 0;\n\n\t\tswitch (randomInteger(entering, exiting)) {\n\t\t\tcase entering:\n\t\t\t\torigin = elevator.floors()[0];\n\t\t\t\tdestination = randomFloor();\n\t\t\t\tbreak;\n\n\t\t\tcase exiting:\n\t\t\t\torigin = randomFloor();\n\t\t\t\tdestination = elevator.floors()[0];\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\torigin = randomFloor();\n\t\t\t\tdestination = randomFloor();\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (origin === destination) return;\n\n\t\tconst direction = origin < destination ? UP : DOWN;\n\n\t\tlet destinationEntered = false;\n\n\t\tconst cancelListener = elevator.on.doorsOpen((floor, elevatorDirection, canChangeDirection) => {\n\t\t\tif (!destinationEntered && floor === origin) {\n\t\t\t\tif (canChangeDirection || elevatorDirection === direction) {\n\t\t\t\t\televator.addDestination(destination);\t\t\n\t\t\t\t\tdestinationEntered = true;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (destinationEntered && floor === destination) {\n\t\t\t\televator.allowDoorsToClose();\n\t\t\t\tcancelListener();\n\t\t\t}\n\t\t});\n\n\t\televator.requestElevator(origin, direction);\n\t\t\n\t}\n\n\tconst elapseTime = () => {\n\n\t\tif (Math.random() < spawnChance) {\n\t\t\tspawn();\n\t\t}\n\n\t};\n\n\treturn {\n\t\ttoggle,\n\t\tspawn,\n\t\tenabled,\n\t};\n\n}\n\nexport default provideUsageSimulator;","import {useState} from 'react';\n\nconst useForceUpdate = () => {\n\tconst [, update] = useState();\n\treturn () => update({});\n}\n\nexport default useForceUpdate;","import React, {useState, useEffect} from 'react';\nimport cx from 'classnames';\nimport useAsyncState from '../hooks/useAsyncState';\n\nconst AUTOPLAY_INTERVAL = 800;\nconst AUTOPLAY_OPEN_TIMEOUT = 5;\n\nconst TimeController = ({elevator}) => {\n\n\tconst [asyncAutoplay, setAutoplay] = useAsyncState(true);\n\n\tuseEffect(() => {\n\t\tif (asyncAutoplay.value) startAutoplay();\n\t}, []);\n\n\tconst applySingleTimestep = () => {\n\t\tsetAutoplay(false);\n\t\televator.elapseTime();\n\t}\n\n\tconst startAutoplay = () => {\n\t\tsetAutoplay(true);\n\t\televator.setOpenTimeout(AUTOPLAY_OPEN_TIMEOUT);\n\t\tsetTimeout(applyAutoplayTimestep);\n\t}\n\n\tconst applyAutoplayTimestep = () => {\n\t\tif (asyncAutoplay.value) {\n\t\t\televator.elapseTime();\n\t\t\tsetTimeout(applyAutoplayTimestep, AUTOPLAY_INTERVAL);\n\t\t\treturn;\n\t\t}\n\n\t\televator.setOpenTimeout(0);\n\t}\n\n\treturn (\n\t\t<div className='row'>\n\t\t\t<button \n\t\t\t\tchildren='|>'\n\t\t\t\tonClick={applySingleTimestep}/>\n\n\t\t\t<button \n\t\t\t\tchildren='>>'\n\t\t\t\tclassName={cx(asyncAutoplay.value && 'toggled')}\n\t\t\t\tonClick={startAutoplay}/>\n\t\t</div>\n\t);\n};\n\nexport default TimeController;","import React from 'react';\nimport cx from 'classnames';\nimport useForceUpdate from '../hooks/useForceUpdate';\n\n\nconst TestSettingsController = ({usageSimulator}) => {\n\n\tconst forceUpdate = useForceUpdate();\n\n\treturn (\n\t\t<div className='row'>\n\t\t\t<button \n\t\t\t\tonClick={() => {\n\t\t\t\t\tusageSimulator.spawn();\n\t\t\t\t\tforceUpdate();\n\t\t\t\t}}\n\t\t\t\tchildren='Random passenger'/>\n\t\t\t<button \n\t\t\t\tclassName={cx(usageSimulator.enabled() && 'toggled')}\n\t\t\t\tonClick={() => {\n\t\t\t\t\tusageSimulator.toggle();\n\t\t\t\t\tforceUpdate();\n\t\t\t\t}}\n\t\t\t\tchildren='Simulate usage'/>\n\t\t</div>\n\t);\n};\n\nexport default TestSettingsController;","import {useEffect} from 'react';\nimport useForceUpdate from './useForceUpdate';\n\nconst useForceUpdateOnEvents = (subscribeMethods) => {\n\tconst forceUpdate = useForceUpdate();\n\tuseEffect(() => {\n\t\tconst unsubscribeMethods = [];\n\t\tsubscribeMethods.forEach(\n\t\t\tsubscribe => unsubscribeMethods.push(subscribe(forceUpdate))\n\t\t);\n\n\t\treturn () => unsubscribeMethods.forEach(unsubscribe => unsubscribe());\n\t}, []);\n}\n\nexport default useForceUpdateOnEvents;","import React, {useEffect} from 'react';\nimport cx from 'classnames';\nimport {DOWN, UP} from '../constants/direction';\nimport useForceUpdateOnEvents from '../hooks/useForceUpdateOnEvents';\n\nconst FloorDisplay = ({floor, elevator}) => {\n\n\tuseForceUpdateOnEvents([\n\t\televator.on.floorChange,\n\t\televator.on.doorsOpen,\n\t\televator.on.doorsClose,\n\t\televator.on.elevatorRequested,\n\t]);\n\n\tconst isDoorOpen = () => elevator.currentFloor() == floor && elevator.isOpen()\n\n\tconst isAtThisFloor = () => elevator.currentFloor() == floor;\n\n\tconst thisIsTopFloor = () => floor === +elevator.floors().slice(-1);\n\n\tconst thisIsBottomFloor = () => floor === elevator.floors()[0];\n\n\tconst isRequested = direction => elevator.isRequested(floor, direction)\n\n\tconst requestElevator = direction => () => elevator.requestElevator(floor, direction);\n\n\treturn (\n\t\t<div className={cx('row', 'floor-display', isAtThisFloor() && 'highlight')}>\n\t\t\t<div>\n\t\t\t\tFloor {floor}\n\t\t\t</div>\n\t\t\t\n\t\t\t<button \n\t\t\t\tclassName={cx(isRequested(DOWN) && 'toggled')}\n\t\t\t\tonClick={requestElevator(DOWN)}\n\t\t\t\tdisabled={thisIsBottomFloor()}\n\t\t\t\tchildren='Down'/>\n\t\t\t\n\t\t\t<button \n\t\t\t\tclassName={cx(isRequested(UP) && 'toggled')}\n\t\t\t\tonClick={requestElevator(UP)}\n\t\t\t\tdisabled={thisIsTopFloor()}\n\t\t\t\tchildren='Up'/>\n\t\t\t\n\t\t\t{isDoorOpen()\n\t\t\t\t? <div className='highlight2'>Open</div>\n\t\t\t\t: <div className='hidden'>Open</div>\n\t\t\t}\n\t\t</div>\n\t);\n};\n\nexport default FloorDisplay;","import React, {useEffect} from 'react';\nimport cx from 'classnames';\nimport {DOWN, UP} from '../constants/direction';\nimport useForceUpdate from '../hooks/useForceUpdate';\nimport useForceUpdateOnEvents from '../hooks/useForceUpdateOnEvents';\n\nconst ElevatorDisplay = ({elevator}) => {\n\n\tuseForceUpdateOnEvents([\n\t\televator.on.doorsOpen,\n\t\televator.on.destinationAdded,\n\t]);\n\n\treturn (\n\t\t<div className='elevator-display'>\n\t\t\t{elevator.floors().map((floor) =>\n\t\t\t\t<button\n\t\t\t\t\tchildren={floor}\n\t\t\t\t\tkey={floor}\n\t\t\t\t\tclassName={\n\t\t\t\t\t\tcx(elevator.isDestination(floor) && 'toggled')\n\t\t\t\t\t}\n\t\t\t\t\tonClick={() => elevator.addDestination(floor)}/>\n\t\t\t)}\n\t\t</div>\n\t);\n};\n\nexport default ElevatorDisplay;","import React, {useState} from 'react';\nimport './App.css';\n\nimport provideElevator from './models/elevator';\nimport provideUsageSimulator from './models/usageSimulator';\n\nimport TimeController from './components/TimeController'\nimport TestSettingsController from './components/TestSettingsController'\nimport FloorDisplay from './components/FloorDisplay';\nimport ElevatorDisplay from './components/ElevatorDisplay';\n\nconst FLOOR_COUNT = 10;\n\nconst elevator = provideElevator(FLOOR_COUNT);\nconst usageSimulator = provideUsageSimulator(elevator);\n\nfunction App() {\n\n\treturn (\n\t\t<div className='app'>\n\t\t\t\n\t\t\t<div className='panel row top-bar'>\n\t\t\t\t<TimeController elevator={elevator}/>\n\t\t\t\t<TestSettingsController usageSimulator={usageSimulator}/>\n\t\t\t</div>\n\n\t\t\t<div className='row'>\n\t\t\t\t<div className='floor-bank panel'>\n\t\t\t\t\t{elevator.floors().map(floor =>\n\t\t\t\t\t\t<FloorDisplay \n\t\t\t\t\t\t\tfloor={floor}\n\t\t\t\t\t\t\televator={elevator}\n\t\t\t\t\t\t\tkey={floor}/>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t\t<ElevatorDisplay elevator={elevator}/>\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}